# é¦™è•‰CMS éƒ¨ç½²æŒ‡å—

## ç¯å¢ƒè¦æ±‚

- PHP >= 8.0
- MySQL >= 5.7
- Apache / Nginx

## éƒ¨ç½²æ­¥éª¤

### 1. ä¸Šä¼ æ–‡ä»¶

å°†æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ Web ç›®å½•

### 2. è¿è¡Œå®‰è£…å‘å¯¼

> ğŸ’¡ å»ºè®®å…ˆé…ç½® SSL è¯ä¹¦ï¼Œå†è¿›è¡Œå®‰è£…

è®¿é—® `https://ä½ çš„åŸŸå/install.php`ï¼ŒæŒ‰å‘å¯¼å¡«å†™ï¼š
- æ•°æ®åº“ä¿¡æ¯
- ç®¡ç†å‘˜è´¦å·
- è‡ªå®šä¹‰åå°å…¥å£è·¯å¾„ï¼ˆå®‰å…¨è€ƒè™‘ï¼Œé¿å…ä½¿ç”¨é»˜è®¤çš„ adminï¼‰
- ç«™ç‚¹ä¿¡æ¯

å®‰è£…å®Œæˆåï¼š
- è‡ªåŠ¨åˆ›å»º `config/install.lock` é”å®šå®‰è£…
- è‡ªåŠ¨åˆ é™¤æ•æ„Ÿæ–‡ä»¶ï¼ˆinstall.phpã€data.sqlã€*.md ç­‰ï¼‰

### 3. é…ç½®ä¼ªé™æ€

> ğŸ’¡ å®‰è£…å®Œæˆåï¼Œç³»ç»Ÿä¼šæ ¹æ®æ‚¨çš„æœåŠ¡å™¨ç±»å‹å’Œåå°å…¥å£è‡ªåŠ¨ç”Ÿæˆä¼ªé™æ€è§„åˆ™ï¼Œç›´æ¥å¤åˆ¶ä½¿ç”¨å³å¯ã€‚

#### Nginxï¼ˆå®å¡”é¢æ¿ï¼‰

å¤åˆ¶ä»¥ä¸‹å†…å®¹åˆ°ç«™ç‚¹è®¾ç½® â†’ ä¼ªé™æ€ï¼š

```nginx
# Sitemap
location = /sitemap.xml {
    rewrite ^ /sitemap.php last;
}

# ç¦æ­¢è®¿é—®æ•æ„Ÿç›®å½•
location ~ ^/(config|core|models|controllers|views|runtime)/ {
    deny all;
}

# é™æ€èµ„æºç›´æ¥è®¿é—®
location /static/ {
    try_files $uri =404;
}

location /upload/ {
    try_files $uri =404;
}

# æ‰€æœ‰è¯·æ±‚ç»Ÿä¸€ç”± index.php å¤„ç†
location / {
    try_files $uri $uri/ /index.php?s=$uri&$args;
}
```

#### Apache

åœ¨ç½‘ç«™æ ¹ç›®å½•åˆ›å»º `.htaccess` æ–‡ä»¶ï¼š

```apache
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Sitemap
    RewriteRule ^sitemap\.xml$ sitemap.php [QSA,L]

    # æ‰€æœ‰è¯·æ±‚ç»Ÿä¸€ç”± index.php å¤„ç†
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php?s=$1 [QSA,L]
</IfModule>

<IfModule mod_negotiation.c>
    Options -MultiViews
</IfModule>

AcceptPathInfo On

# ç¦æ­¢è®¿é—®æ•æ„Ÿç›®å½•
<FilesMatch "^(config|core|models|controllers|views|runtime)">
    Order deny,allow
    Deny from all
</FilesMatch>
```

### 4. è®¿é—®æµ‹è¯•

- å‰å°: `https://ä½ çš„åŸŸå/`
- åå°: `https://ä½ çš„åŸŸå/ä½ è®¾ç½®çš„åå°è·¯å¾„`ï¼ˆä¼ªé™æ€ç”Ÿæ•ˆåæ— éœ€ .php åç¼€ï¼‰
- API: `https://ä½ çš„åŸŸå/api.php?action=vod.list`
- Sitemap: `https://ä½ çš„åŸŸå/sitemap.xml`

## ç®¡ç†å‘˜è´¦å·

ç®¡ç†å‘˜è´¦å·å’Œåå°å…¥å£è·¯å¾„åœ¨å®‰è£…å‘å¯¼ä¸­è®¾ç½®ï¼Œæ²¡æœ‰é»˜è®¤å€¼ã€‚

- åå°åœ°å€: å®‰è£…æ—¶è‡ªå®šä¹‰ï¼ˆå¦‚ `/manage.php`ã€`/backend.php`ï¼‰
- è´¦å·å¯†ç : å®‰è£…æ—¶è‡ªè¡Œè®¾ç½®

## SEO è¯´æ˜

- `robots.txt` - å·²é…ç½®ï¼Œå±è”½åå°ã€æœç´¢ã€ç”¨æˆ·é¡µé¢
- `sitemap.xml` - æ”¯æŒåˆ†ç‰‡ï¼Œæ¯ç‰‡æœ€å¤š5000æ¡URL
  - `/sitemap.xml` - ç´¢å¼•æ–‡ä»¶
  - `/sitemap.xml?type=main` - é¦–é¡µã€åˆ†ç±»ç­‰
  - `/sitemap.xml?type=vod&page=1` - è§†é¢‘åˆ†ç‰‡
  - `/sitemap.xml?type=actor&page=1` - æ¼”å‘˜åˆ†ç‰‡
  - `/sitemap.xml?type=art&page=1` - æ–‡ç« åˆ†ç‰‡
- æœç´¢é¡µã€ç”¨æˆ·é¡µå·²æ·»åŠ  `noindex` æ ‡ç­¾ï¼Œé˜²æ­¢è¢«åˆ·ç•™ç—•

## ç›®å½•ç»“æ„

```
bananacms/
â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶ï¼ˆç¦æ­¢å¤–éƒ¨è®¿é—®ï¼‰
â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨
â”œâ”€â”€ core/            # æ ¸å¿ƒç±»
â”œâ”€â”€ models/          # æ¨¡å‹
â”œâ”€â”€ runtime/         # è¿è¡Œæ—¶ç›®å½•ï¼ˆç¼“å­˜ã€æ—¥å¿—ï¼‰
â”œâ”€â”€ static/          # é™æ€èµ„æº
â”œâ”€â”€ template/        # å‰å°æ¨¡æ¿
â”œâ”€â”€ upload/          # ä¸Šä¼ æ–‡ä»¶
â”œâ”€â”€ views/           # åå°è§†å›¾
â”œâ”€â”€ index.php        # å‰å°å…¥å£
â”œâ”€â”€ api.php          # APIå…¥å£
â””â”€â”€ [è‡ªå®šä¹‰].php     # åå°å…¥å£ï¼ˆå®‰è£…æ—¶è‡ªå®šä¹‰ï¼‰
```

## å¸¸è§é—®é¢˜

### Q: é¡µé¢æ˜¾ç¤ºç©ºç™½
A: æ£€æŸ¥ PHP ç‰ˆæœ¬æ˜¯å¦ >= 8.0ï¼ŒæŸ¥çœ‹ runtime/logs/ ä¸‹çš„é”™è¯¯æ—¥å¿—

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥
A: é‡æ–°è¿è¡Œå®‰è£…å‘å¯¼ `install.php`ï¼Œæ£€æŸ¥æ•°æ®åº“ä¿¡æ¯æ˜¯å¦æ­£ç¡®

### Q: ä¸Šä¼ å›¾ç‰‡å¤±è´¥
A: æ£€æŸ¥ upload ç›®å½•æƒé™ï¼Œç¡®ä¿ PHP æœ‰å†™å…¥æƒé™

### Q: é‡‡é›†å¤±è´¥
A: æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸å¤–éƒ¨è¯·æ±‚ï¼Œæˆ–èµ„æºç«™æ˜¯å¦å¯ç”¨

## ç›¸å…³é“¾æ¥

- Telegram é¢‘é“: [@BananaCMS](https://t.me/BananaCMS)
- å¯¼èˆªç«™: [XPornKitæˆäººå¯¼èˆª](https://xpornkit.com/zh)
- é—®é¢˜åé¦ˆ: [GitHub Issues](https://github.com/bananacms/BananaCMS/issues)