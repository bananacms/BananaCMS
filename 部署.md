# é¦™è•‰CMS ä¸Šçº¿éƒ¨ç½²æŒ‡å—

## ç¯å¢ƒè¦æ±‚

- PHP >= 8.0
- MySQL >= 5.7
- Apache/Nginx
- å¼€å¯ PDO_MySQL æ‰©å±•

## éƒ¨ç½²æ­¥éª¤

### 1. ä¸Šä¼ æ–‡ä»¶

å°†æ‰€æœ‰æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ Web ç›®å½•

### 2. è®¾ç½®ç›®å½•æƒé™

```bash
chmod -R 755 runtime/
chmod -R 755 upload/
chmod -R 755 config/
```

### 3. è¿è¡Œå®‰è£…å‘å¯¼

è®¿é—® `http://ä½ çš„åŸŸå/install.php`ï¼ŒæŒ‰å‘å¯¼å¡«å†™ï¼š
- æ•°æ®åº“ä¿¡æ¯
- ç«™ç‚¹ä¿¡æ¯
- ç®¡ç†å‘˜è´¦å·

å®‰è£…å®Œæˆåä¼šè‡ªåŠ¨åˆ›å»º `config/install.lock` é”å®šå®‰è£…ã€‚

> âš ï¸ **å®‰å…¨æç¤º**ï¼šå®‰è£…å®Œæˆåè¯·æ‰‹åŠ¨åˆ é™¤ `install.php`ã€`data.sql` ä»¥åŠæ‰€æœ‰ `.md` æ–‡æ¡£

### 4. é…ç½®ä¼ªé™æ€

#### Apache (.htaccess)
```apache
<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Sitemap
    RewriteRule ^sitemap\.xml$ sitemap.php [QSA,L]

    # å‰å°è·¯ç”±
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.*)$ index.php/$1 [QSA,L]

    # åå°è·¯ç”±
    RewriteCond %{REQUEST_URI} ^/admin\.php
    RewriteRule ^admin\.php/(.*)$ admin.php?/$1 [QSA,L]
</IfModule>

# ç¦æ­¢è®¿é—®æ•æ„Ÿç›®å½•
<FilesMatch "^(config|core|models|controllers|views|runtime|tests)">
    Order deny,allow
    Deny from all
</FilesMatch>
```

#### Nginx
```nginx
# Sitemap
location = /sitemap.xml {
    rewrite ^ /sitemap.php last;
}

# ç¦æ­¢è®¿é—®æ•æ„Ÿç›®å½•
location ~ ^/(config|core|models|controllers|views|runtime|tests)/ {
    deny all;
}

# å‰å°ä¼ªé™æ€
location / {
    if (!-e $request_filename) {
        rewrite ^(.*)$ /index.php?s=$1 last;
        break;
    }
}
```

> ğŸ’¡ å®Œæ•´é…ç½®æ–‡ä»¶è§ `ä¼ªé™æ€/` ç›®å½•

### 5. è®¿é—®æµ‹è¯•

- å‰å°: `https://ä½ çš„åŸŸå/`
- åå°: `https://ä½ çš„åŸŸå/admin.php`
- API: `https://ä½ çš„åŸŸå/api.php?action=vod.list`
- Sitemap: `https://ä½ çš„åŸŸå/sitemap.xml`

## SEO è¯´æ˜

- `robots.txt` - å·²é…ç½®ï¼Œå±è”½åå°ã€æœç´¢ã€ç”¨æˆ·é¡µé¢
- `sitemap.xml` - æ”¯æŒåˆ†ç‰‡ï¼Œæ¯ç‰‡æœ€å¤š5000æ¡URL
  - `/sitemap.xml` - ç´¢å¼•æ–‡ä»¶
  - `/sitemap.xml?type=main` - é¦–é¡µã€åˆ†ç±»ç­‰
  - `/sitemap.xml?type=vod&page=1` - è§†é¢‘åˆ†ç‰‡
  - `/sitemap.xml?type=actor&page=1` - æ¼”å‘˜åˆ†ç‰‡
  - `/sitemap.xml?type=art&page=1` - æ–‡ç« åˆ†ç‰‡
- æœç´¢é¡µã€ç”¨æˆ·é¡µå·²æ·»åŠ  `noindex` æ ‡ç­¾ï¼Œé˜²æ­¢è¢«åˆ·ç•™ç—•

## ä¸Šçº¿æ£€æŸ¥æ¸…å•

| é¡¹ç›® | çŠ¶æ€ |
|------|------|
| å®‰è£…å‘å¯¼å·²å®Œæˆ | â˜ |
| runtime ç›®å½•å¯å†™ | â˜ |
| upload ç›®å½•å¯å†™ | â˜ |
| ä¼ªé™æ€å·²é…ç½® | â˜ |
| HTTPS å·²å¯ç”¨ | â˜ |

## ç®¡ç†å‘˜è´¦å·

ç®¡ç†å‘˜è´¦å·åœ¨å®‰è£…å‘å¯¼ä¸­è®¾ç½®ï¼Œæ²¡æœ‰é»˜è®¤è´¦å·ã€‚

- åå°åœ°å€: `/admin.php`
- è´¦å·å¯†ç : å®‰è£…æ—¶è‡ªè¡Œè®¾ç½®

## ç›®å½•ç»“æ„

```
bananacms/
â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶ï¼ˆç¦æ­¢å¤–éƒ¨è®¿é—®ï¼‰
â”œâ”€â”€ controllers/     # æ§åˆ¶å™¨
â”œâ”€â”€ core/            # æ ¸å¿ƒç±»
â”œâ”€â”€ models/          # æ¨¡å‹
â”œâ”€â”€ runtime/         # è¿è¡Œæ—¶ç›®å½•ï¼ˆç¼“å­˜ã€æ—¥å¿—ï¼‰
â”œâ”€â”€ static/          # é™æ€èµ„æº
â”œâ”€â”€ template/        # å‰å°æ¨¡æ¿
â”œâ”€â”€ upload/          # ä¸Šä¼ æ–‡ä»¶
â”œâ”€â”€ views/           # åå°è§†å›¾
â”œâ”€â”€ admin.php        # åå°å…¥å£
â”œâ”€â”€ api.php          # APIå…¥å£
â”œâ”€â”€ index.php        # å‰å°å…¥å£
â””â”€â”€ data.sql         # æ•°æ®åº“æ–‡ä»¶
```

## å¸¸è§é—®é¢˜

### Q: é¡µé¢æ˜¾ç¤ºç©ºç™½
A: æ£€æŸ¥ PHP ç‰ˆæœ¬æ˜¯å¦ >= 8.0ï¼ŒæŸ¥çœ‹ runtime/logs/ ä¸‹çš„é”™è¯¯æ—¥å¿—

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥
A: é‡æ–°è¿è¡Œå®‰è£…å‘å¯¼ `install.php`ï¼Œæ£€æŸ¥æ•°æ®åº“ä¿¡æ¯æ˜¯å¦æ­£ç¡®

### Q: ä¸Šä¼ å›¾ç‰‡å¤±è´¥
A: æ£€æŸ¥ upload ç›®å½•æƒé™ï¼Œç¡®ä¿ PHP æœ‰å†™å…¥æƒé™

### Q: é‡‡é›†å¤±è´¥
A: æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦å…è®¸å¤–éƒ¨è¯·æ±‚ï¼Œcurl æ‰©å±•æ˜¯å¦å¼€å¯

## ç›¸å…³é“¾æ¥

- Telegram é¢‘é“: [@BananaCMS](https://t.me/BananaCMS)
- å¯¼èˆªç«™: [XPornKitæˆäººå¯¼èˆª](https://xpornkit.com/zh)
- é—®é¢˜åé¦ˆ: [GitHub Issues](https://github.com/bananacms/BananaCMS/issues)
